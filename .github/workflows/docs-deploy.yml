name: Docs Deploy

on:
    push:
        branches:
            - master

jobs:
    deploy:
        runs-on: ubuntu-latest

        strategy:
            matrix:
                node_version: [14, 16]

        steps:
            # “最近更新时间” 等 git 日志相关信息，需要拉取全部提交记录
            - uses: actions/checkout@v3
              with:
                  fetch-depth: 0

            - name: Install pnpm
              uses: pnpm/action-setup@v2

            - name: Set node version to ${{ matrix.node_version }}
            - uses: actions/setup-node@v3
              with:
                  node-version: ${{ matrix.node_version }}
                  cache: pnpm

            - name: Install deps
              run: pnpm install

            - name: Build
              run: pnpm docs:build

            - name: Deploy
              uses: peaceiris/actions-gh-pages@v3
              with:
                  github_token: ${{ secrets.GITHUB_TOKEN }}
                  publish_dir: web-docs/docs/.vitepress/dist
                  #   publish_branch: your-branch  # default: gh-pages
                  # cname: example.com # if wanna deploy to custom domain
